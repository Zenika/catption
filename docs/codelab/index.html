
<!doctype html>

<html>
<head>
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <meta name="theme-color" content="#4F7DC9">
  <meta charset="UTF-8">
  <title>Basics of writing a Go CLI tool</title>
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Code+Pro:400|Roboto:400,300,400italic,500,700|Roboto+Mono">
  <link rel="stylesheet" href="//fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://storage.googleapis.com/codelab-elements/codelab-elements.css">
  <style>
    .success {
      color: #1e8e3e;
    }
    .error {
      color: red;
    }
  </style>
</head>
<body>
  <google-codelab-analytics gaid="UA-49880327-14"></google-codelab-analytics>
  <google-codelab codelab-gaid=""
                  id="codelab"
                  title="Basics of writing a Go CLI tool"
                  environment="web"
                  feedback-link="https://github.com/Zenika/catption/issues">
    
      <google-codelab-step label="Introduction" duration="0">
        <p>In this codelab you will learn the basics of writing a Go CLI tool.</p>
<h2 class="checklist" is-upgraded>What you&#39;ll learn</h2>
<ul class="checklist">
<li>Setup a development environment</li>
<li>Discover <code>os</code>, <code>os/exec</code> and <code>flag</code> packages</li>
<li>Discover <code>github.com/spf13/cobra</code> CLI library</li>
<li>Create commands and subcommands</li>
<li>Read command flags and args</li>
<li>Discover <code>github.com/spf13/viper</code> config library</li>
<li>Read and write a config file</li>
<li>Put <code>cobra</code> and <code>viper</code> together</li>
<li>Read environment variables</li>
<li>Discover <code>github.com/sirupsen/logrus</code> logging library</li>
<li>Use build time variable injection</li>
<li>Use conditional compilation and build tags</li>
</ul>
<p>The steps marked with a 🎁 are optional.</p>


      </google-codelab-step>
    
      <google-codelab-step label="Ch.1: Introduction" duration="0">
        <h2 class="checklist" is-upgraded>What you&#39;ll learn</h2>
<ul class="checklist">
<li>Setup a development environment</li>
<li>Read args (package <code>os</code>)</li>
<li>Bonus: Read flags (package <code>flag</code>)</li>
</ul>


      </google-codelab-step>
    
      <google-codelab-step label="Ch.1: Setup environment" duration="0">
        <p>In order to go through this codelab, you are going to need a working Go development environment.</p>
<p>The minimum required version is Go 1.12.</p>
<aside class="special"><p>Already have Go installed?<br>Make sure you are running a version &gt;= 1.12 by running <code>go version</code>.<br>If it is the case you may proceed to the next step.</p>
</aside>
<h2 is-upgraded>🐧 Linux</h2>
<aside class="warning"><p>Do not use <code>apt</code> (old versions of Go)</p>
</aside>
<h3 is-upgraded>snap</h3>
<p>Run:</p>
<pre><code>sudo snap install go --classic
</code></pre>
<h3 is-upgraded>tarbal</h3>
<p>Follow the instructions at <a href="https://golang.org/doc/install#tarball" target="_blank">https://golang.org/doc/install#tarball</a></p>
<h2 is-upgraded>🍏 Mac OS</h2>
<p>Download the package file at <a href="https://golang.org/dl/" target="_blank">https://golang.org/dl/</a>, open it, and follow the prompts.</p>
<h2 is-upgraded>🏁 Windows</h2>
<p>Download the MSI file at <a href="https://golang.org/dl/" target="_blank">https://golang.org/dl/</a>, open it, and follow the prompts.</p>
<aside class="special"><p>Check your installation by running <code>go version</code> and <code>go env</code>.</p>
</aside>


      </google-codelab-step>
    
      <google-codelab-step label="Ch.1: Download codelab" duration="0">
        <p>There are two ways of downloading the codelab contents.<br>The prefered way is <code>git</code>, which will allow you to keep track of your work and revert things if needed.</p>
<h2 is-upgraded>git</h2>
<p>Run:</p>
<pre><code>git clone https://github.com/Zenika/catption.git
</code></pre>
<h2 is-upgraded>zip</h2>
<p>Download <a href="https://github.com/Zenika/catption/archive/master.zip" target="_blank">https://github.com/Zenika/catption/archive/master.zip</a> and unzip it.</p>
<aside class="special"><p>Each chapter of the codelab has its own directory:<br><br><code>📂 catption<br>|-📂 codelab<br>| |-📁 chapter1<br>| |-📁 chapter2</code><br><br>Run <code>cd catption/codelab/chapter1</code> to go to chapter 1.</p>
</aside>


      </google-codelab-step>
    
      <google-codelab-step label="Ch.1: Choose an IDE" duration="0">
        <p>The last thing you need is a Go friendly IDE.</p>
<p>If you don&#39;t already have one, here are some popular IDEs for Go:</p>
<ul>
<li><a href="https://code.visualstudio.com/" target="_blank">Visual Studio Code</a> + <a href="https://github.com/microsoft/vscode-go" target="_blank">vscode-go</a></li>
<li><a href="https://www.jetbrains.com/go/" target="_blank">Goland</a></li>
<li>vim + <a href="https://github.com/fatih/vim-go" target="_blank">vim-go</a></li>
</ul>
<p>Now open the codelab contents and you are ready 👷, let&#39;s Go!</p>


      </google-codelab-step>
    
      <google-codelab-step label="Ch.1: Read args" duration="0">
        <h2 is-upgraded>Run <code>hello.go</code></h2>
<p>In <code>📂catption/codelab/chapter1</code> you will find a classic <code>hello.go</code>:</p>
<pre><code>package main

import (
	&#34;fmt&#34;
)

func main() {
	fmt.Println(&#34;Hello World!&#34;)
}
</code></pre>
<p>⌨ Execute this program by running <code>go run .</code>.</p>
<h2 is-upgraded>Format the message</h2>
<p>We would like to replace <code>World</code> by a variable in our message.</p>
<p>⌨ Create a new string variable:</p>
<pre><code>var recipient = &#34;Gopher&#34;
</code></pre>
<p>⌨ Use <a href="https://pkg.go.dev/fmt?tab=doc#Printf" target="_blank"><code>fmt.Printf()</code></a> to format the message with <code>recipient</code>.</p>
<aside class="warning"><p>Unlike <code>fmt.Println()</code>, <code>fmt.Printf()</code> does not add a new line at the end of the string.<br>You must add it by appending <code>\n</code> at the end of the message.</p>
</aside>
<h2 is-upgraded>Read command line arguments</h2>
<p>As you can see the main function of a Go program has no parameters.</p>
<p>The command line arguments are available in the <a href="https://pkg.go.dev/os?tab=doc#pkg-variables" target="_blank"><code>Args</code> variable of the <code>os</code> package</a>.</p>
<aside class="special"><p><code>os.Args</code> has the type <code>[]string</code> (slice of string).<br>A slice is a variable length array.</p>
</aside>
<p>⌨ Use <code>os.Args</code> to fill the <code>recipient</code> variable.</p>
<aside class="special"><p><a href="https://pkg.go.dev/strings?tab=doc#Join" target="_blank"><code>strings.Join</code></a> concatenates the elements of a slice of strings.</p>
</aside>
<aside class="special"><p>To extract a subset of a slice, use the slice operator:<br><br><code>var ii = []int{1, 2, 3, 4}<br>ii[2:] // [3, 4]<br></code></p>
</aside>


      </google-codelab-step>
    
      <google-codelab-step label="Ch.1: 🎁 Interpret flags" duration="0">
        <p>Flags allow to change the behavior of commands, like the <code>-r</code> flag of <code>rm</code> which enables recursive removal.</p>
<p>The <a href="https://pkg.go.dev/flag?tab=doc" target="_blank"><code>flag</code> package</a> allows to parse the flags contained in <code>os.Args</code>.</p>
<p>We would like our command to have a <code>-u</code> flag which uppercases the message.</p>
<p>⌨ Explore the <code>flag</code> package and parse the <code>-u</code> flag in <code>hello.go</code>.</p>
<aside class="special"><p><a href="https://pkg.go.dev/flag?tab=doc#Args" target="_blank"><code>flag.Args</code></a> returns the non-flag command-line arguments.</p>
</aside>
<aside class="special"><p><a href="https://pkg.go.dev/strings?tab=doc#ToUpper" target="_blank"><code>strings.ToUpper</code></a> returns an upper case copy of a string.</p>
</aside>


      </google-codelab-step>
    
      <google-codelab-step label="Ch.1: End" duration="0">
        <p>🎉 Congratulations! You have completed chapter 1.</p>
<h2 class="checklist" is-upgraded>What we&#39;ve covered</h2>
<ul class="checklist">
<li>Setup a development environment</li>
<li>Read args (package <code>os</code>)</li>
<li>Bonus: Read flags (package <code>flag</code>)</li>
</ul>


      </google-codelab-step>
    
      <google-codelab-step label="Ch.2: Introduction" duration="0">
        <h2 class="checklist" is-upgraded>What you&#39;ll learn</h2>
<ul class="checklist">
<li>Discover <code>github/spf13/cobra</code></li>
<li>Create a cobra command</li>
<li>🎁 Validate arguments</li>
</ul>


      </google-codelab-step>
    
      <google-codelab-step label="Ch.2: github/spf13/cobra" duration="0">
        

      </google-codelab-step>
    
      <google-codelab-step label="Ch.2: Create a command" duration="0">
        

      </google-codelab-step>
    
      <google-codelab-step label="Ch.2: 🎁 Validate arguments" duration="0">
        

      </google-codelab-step>
    
      <google-codelab-step label="Ch.2: End" duration="0">
        <h2 class="checklist" is-upgraded>What we&#39;ve covered</h2>
<ul class="checklist">
<li>Discover <code>github/spf13/cobra</code></li>
<li>Create a cobra command</li>
<li>🎁 Validate arguments</li>
</ul>


      </google-codelab-step>
    
      <google-codelab-step label="Chapitre 3" duration="0">
        <ul>
<li>Interprétation des flags</li>
<li>🎁 TODO</li>
</ul>


      </google-codelab-step>
    
      <google-codelab-step label="Chapitre 4" duration="0">
        <ul>
<li>Découverte de viper</li>
<li>Lecture d&#39;un fichier de config</li>
<li>🎁 TODO</li>
</ul>


      </google-codelab-step>
    
      <google-codelab-step label="Chapitre 5" duration="0">
        <ul>
<li>Connexion cobra/viper</li>
<li>🎁 Lecture variable d&#39;environnement</li>
</ul>


      </google-codelab-step>
    
      <google-codelab-step label="Chapitre 6" duration="0">
        <ul>
<li>Création d&#39;une sous-commande</li>
<li>Écriture d&#39;un fichier de config</li>
<li>🎁 Injection de variable à la compilation</li>
</ul>


      </google-codelab-step>
    
      <google-codelab-step label="Chapitre 7" duration="0">
        <ul>
<li>Interprétation d&#39;un flag custom</li>
<li>🎁 Utilisation de logrus</li>
</ul>


      </google-codelab-step>
    
      <google-codelab-step label="Chapitre 8" duration="0">
        <ul>
<li>Découverte du package <code>os/exec</code></li>
<li>Découverte de la compilation conditionnelle</li>
<li>🎁 Découverte des build tags</li>
</ul>


      </google-codelab-step>
    
      <google-codelab-step label="frequently asked questions" duration="0">
        <p>test</p>


      </google-codelab-step>
    
  </google-codelab>

  <script src="https://storage.googleapis.com/codelab-elements/native-shim.js"></script>
  <script src="https://storage.googleapis.com/codelab-elements/custom-elements.min.js"></script>
  <script src="https://storage.googleapis.com/codelab-elements/prettify.js"></script>
  <script src="https://storage.googleapis.com/codelab-elements/codelab-elements.js"></script>

</body>
</html>
